<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Bilibili Ticket Rush</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <div id="notification-container"></div>
        <div id="sidebar">
            <div class="app-header">
                <div class="app-title">BTR</div>
                <div class="app-version">v7.0.0</div>
            </div>
            <nav class="nav-tabs">
                <a class="nav-tab active" data-tab="home">首页</a>
                <a class="nav-tab" data-tab="grab">运行</a>
                <a class="nav-tab" data-tab="projects">项目列表</a>
                <a class="nav-tab" data-tab="accounts">账号管理</a>
    
                <a class="nav-tab" data-tab="settings">设置</a>
                <a class="nav-tab" data-tab="help">帮助</a>
            </nav>
        </div>

        <div id="main-content">
            <div id="tab-home" class="tab-content active">
                <div class="card">
                    <h2 class="card-title">欢迎使用 BTR</h2>
                    <p class="text-secondary mb-16">
                        Bilibili Ticket Rush - 哔哩哔哩会员购抢票工具
                    </p>
                </div>
                <div class="card">
                    <h3 class="card-title">快速开始</h3>
                    <p class="quick-start-item">1. 在"账号管理"中添加B站账号</p>
                    <p class="quick-start-item">
                        2. 在"项目列表"中选择要抢票的项目
                    </p>
                    <p class="quick-start-item">3. 在"设置"中配置抢票参数</p>
                    <p class="quick-start-item">4. 在"运行"页面开始抢票</p>
                </div>
                <div class="card">
                    <h3 class="card-title">系统信息</h3>
                    <div class="stats-grid">
                        <div>
                            <div class="stats-label">版本</div>
                            <div class="stats-value">v7.0.0</div>
                        </div>
                        <div>
                            <div class="stats-label">运行时间</div>
                            <div class="stats-value" id="uptime">0 分钟</div>
                        </div>
                        <div>
                            <div class="stats-label">账号数量</div>
                            <div class="stats-value" id="account-count">0</div>
                        </div>
                        <div>
                            <div class="stats-label">日志数量</div>
                            <div class="stats-value" id="log-count">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-grab" class="tab-content">
                <div class="card">
                    <h2 class="card-title">操作控制</h2>
                    <div class="monitor-controls">
                        <button class="btn btn-success" id="start-grab-btn">
                            开始任务
                        </button>
                        <button class="btn btn-danger" id="stop-grab-btn">
                            停止任务
                        </button>
                    </div>
                    <div class="monitor-status-box">
                        <span class="status-label"> 当前状态： </span>
                        <span class="stats-value" id="monitor-status">
                            空闲
                        </span>
                    </div>
                </div>
                <div class="card">
                    <h2 class="card-title">运行日志</h2>
                    <div class="monitor-controls">
                        <button
                            class="btn btn-primary"
                            id="refresh-grab-logs-btn"
                        >
                            重载日志
                        </button>
                        <button class="btn btn-danger" id="clear-grab-logs-btn">
                            清空日志
                        </button>
                        <button class="btn btn-info" id="auto-scroll-btn">
                            自动滚动: 开启
                        </button>
                    </div>
                    <div class="log-filter-controls" style="margin-top: 10px">
                        <input
                            type="text"
                            id="log-search"
                            class="log-search"
                            placeholder="搜索日志..."
                        />
                        <button
                            class="log-filter-btn active"
                            id="filter-info-btn"
                        >
                            信息
                        </button>
                        <button
                            class="log-filter-btn active"
                            id="filter-debug-btn"
                        >
                            调试
                        </button>
                        <button
                            class="log-filter-btn active"
                            id="filter-warn-btn"
                        >
                            警告
                        </button>
                        <button
                            class="log-filter-btn active"
                            id="filter-error-btn"
                        >
                            错误
                        </button>
                        <button
                            class="log-filter-btn active"
                            id="filter-success-btn"
                        >
                            成功
                        </button>
                    </div>
                    <div class="log-stats" style="margin-top: 10px">
                        <span
                            >日志总数: <span id="grab-log-count">0</span></span
                        >
                        <span style="margin-left: 20px"
                            >信息: <span id="info-count">0</span></span
                        >
                        <span style="margin-left: 20px"
                            >调试: <span id="debug-count">0</span></span
                        >
                        <span style="margin-left: 20px"
                            >警告: <span id="warn-count">0</span></span
                        >
                        <span style="margin-left: 20px"
                            >错误: <span id="error-count">0</span></span
                        >
                    </div>
                    <div
                        id="grab-logs-container"
                        class="log-container grab-log-container"
                        style="margin-top: 16px; height: 500px"
                    ></div>
                </div>
            </div>

            <div id="tab-accounts" class="tab-content">
                <div class="card">
                    <h2 class="card-title">账号管理</h2>
                    <div class="monitor-controls">
                        <button class="btn btn-primary" id="add-account-btn">
                            添加账号
                        </button>
                        <button
                            class="btn btn-success"
                            id="reload-accounts-btn"
                        >
                            刷新
                        </button>
                    </div>
                    <div id="accounts-loading" class="loading">
                        <div class="spinner"></div>
                        <div>加载中...</div>
                    </div>
                    <ul
                        id="accounts-list"
                        class="account-list display-none"
                    ></ul>
                </div>
            </div>

            <!-- Projects Tab -->
            <div id="tab-projects" class="tab-content">
                <div class="card">
                    <h2 class="card-title">项目列表</h2>
                    <div style="display: flex; gap: 12px; margin-bottom: 20px">
                        <button
                            class="btn btn-primary"
                            onclick="refreshProjects()"
                        >
                            刷新项目
                        </button>
                        <button class="btn btn-success" onclick="addProject()">
                            添加项目
                        </button>
                    </div>
                    <div id="projects-loading" class="loading">
                        <div class="spinner"></div>
                        <div>加载项目中...</div>
                    </div>
                    <div
                        id="projects-list"
                        class="project-list"
                        style="display: none"
                    ></div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="tab-settings" class="tab-content">
                <div class="card">
                    <h2 class="card-title">抢票设置</h2>
                    <div class="settings-group">
                        <div class="settings-title">基本设置</div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">抢票模式</div>
                                <div class="settings-description">
                                    选择抢票的工作模式
                                </div>
                            </div>
                            <select class="select-input" id="grab-mode">
                                <option value="0">普通模式</option>
                                <option value="1">快速模式</option>
                                <option value="2">捡漏模式</option>
                            </select>
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">延迟时间(秒)</div>
                                <div class="settings-description">
                                    每次请求之间的延迟时间
                                </div>
                            </div>
                            <input
                                type="number"
                                class="number-input"
                                id="delay-time"
                                value="2"
                                min="1"
                                max="10"
                            />
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">最大尝试次数</div>
                                <div class="settings-description">
                                    每个账号的最大抢票尝试次数
                                </div>
                            </div>
                            <input
                                type="number"
                                class="number-input"
                                id="max-attempts"
                                value="100"
                                min="1"
                                max="1000"
                            />
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">Token重试次数</div>
                                <div class="settings-description">获取抢票Token失败时的最大重试次数</div>
                            </div>
                            <input type="number" class="number-input" id="max-token-retry" value="5" min="1" max="100">
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">订单确认重试次数</div>
                                <div class="settings-description">确认订单失败时的最大重试次数</div>
                            </div>
                            <input type="number" class="number-input" id="max-confirm-retry" value="4" min="1" max="100">
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">假票检测重试次数</div>
                                <div class="settings-description">下单后检测是否为假票的最大重试次数</div>
                            </div>
                            <input type="number" class="number-input" id="max-fake-check-retry" value="10" min="1" max="100">
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">下单重试次数</div>
                                <div class="settings-description">创建订单失败时的最大重试次数</div>
                            </div>
                            <input type="number" class="number-input" id="max-order-retry" value="30" min="1" max="1000">
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">重试间隔(毫秒)</div>
                                <div class="settings-description">每次重试之间的等待时间</div>
                            </div>
                            <input type="number" class="number-input" id="retry-interval-ms" value="400" min="10" max="5000" style="width: 120px;">
                        </div>
                        <div class="settings-item" id="skip-words-settings" style="display: none;">
                            <div>
                                <div class="settings-label">过滤关键词</div>
                                <div class="settings-description">
                                    捡漏模式下，跳过包含这些关键词的场次或票种 (多个关键词用逗号分隔)
                                </div>
                            </div>
                            <textarea
                                class="form-input"
                                id="skip-words-input"
                                placeholder="例如: 专属,VIP,内场"
                                rows="3"
                                style="width: 300px;"
                            ></textarea>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-title">推送设置</div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">启用推送通知</div>
                                <div class="settings-description">
                                    抢票成功或失败时发送通知
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="enable-push" />
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="settings-item">
                            <div>
                                <div class="settings-label">启用推送渠道</div>
                                <div class="settings-description">
                                    选择要启用的推送渠道
                                </div>
                            </div>
                            <div class="push-methods-grid">
                                <label class="checkbox-card">
                                    <input type="checkbox" id="push-method-bark" />
                                    <span>Bark</span>
                                </label>
                                <label class="checkbox-card">
                                    <input type="checkbox" id="push-method-pushplus" />
                                    <span>PushPlus</span>
                                </label>
                                <label class="checkbox-card">
                                    <input type="checkbox" id="push-method-fangtang" />
                                    <span>方糖</span>
                                </label>
                                <label class="checkbox-card">
                                    <input type="checkbox" id="push-method-dingtalk" />
                                    <span>钉钉</span>
                                </label>
                                <label class="checkbox-card">
                                    <input type="checkbox" id="push-method-wechat" />
                                    <span>企微</span>
                                </label>
                                <label class="checkbox-card">
                                    <input type="checkbox" id="push-method-gotify" />
                                    <span>Gotify</span>
                                </label>
                                <label class="checkbox-card">
                                    <input type="checkbox" id="push-method-dungeon" />
                                    <span>Dungeon</span>
                                </label>
                            </div>
                        </div>

                        <div id="push-settings-containers">
                            <div class="settings-subgroup channel-settings" id="bark-settings">
                                <div class="settings-subtitle">Bark 配置</div>
                                <div class="settings-item-inner">
                                    <label class="form-label">Bark Token</label>
                                    <input type="text" class="form-input" id="bark-token" placeholder="输入Bark Token" />
                                </div>
                            </div>

                            <div class="settings-subgroup channel-settings" id="pushplus-settings">
                                <div class="settings-subtitle">PushPlus 配置</div>
                                <div class="settings-item-inner">
                                    <label class="form-label">PushPlus Token</label>
                                    <input type="text" class="form-input" id="pushplus-token" placeholder="输入PushPlus Token" />
                                </div>
                            </div>

                            <div class="settings-subgroup channel-settings" id="fangtang-settings">
                                <div class="settings-subtitle">方糖推送 配置</div>
                                <div class="settings-item-inner">
                                    <label class="form-label">方糖推送Token</label>
                                    <input type="text" class="form-input" id="fangtang-token" placeholder="输入方糖推送Token" />
                                </div>
                            </div>

                            <div class="settings-subgroup channel-settings" id="dingtalk-settings">
                                <div class="settings-subtitle">钉钉机器人 配置</div>
                                <div class="settings-item-inner">
                                    <label class="form-label">钉钉机器人Token</label>
                                    <input type="text" class="form-input" id="dingtalk-token" placeholder="输入钉钉机器人Token" />
                                </div>
                            </div>

                            <div class="settings-subgroup channel-settings" id="wechat-settings">
                                <div class="settings-subtitle">企业微信 配置</div>
                                <div class="settings-item-inner">
                                    <label class="form-label">企业微信Token</label>
                                    <input type="text" class="form-input" id="wechat-token" placeholder="输入企业微信Token" />
                                </div>
                            </div>

                            <div class="settings-subgroup channel-settings" id="gotify-settings">
                                <div class="settings-subtitle">Gotify 配置</div>
                                <div class="settings-item-inner">
                                    <label class="form-label">Gotify URL</label>
                                    <input type="text" class="form-input" id="gotify-url" placeholder="http://your-gotify-server.com" />
                                </div>
                                <div class="settings-item-inner mt-8">
                                    <label class="form-label">Gotify Token</label>
                                    <input type="text" class="form-input" id="gotify-token" placeholder="输入Gotify Token" />
                                </div>
                            </div>

                            <div class="settings-subgroup channel-settings" id="dungeon-settings">
                                <div class="settings-subtitle">Dungeon (Coyote 3) 配置</div>
                                <div class="settings-grid">
                                    <div class="settings-item-inner">
                                        <label class="form-label">设备标识</label>
                                        <input type="text" class="form-input" id="dungeon-device-id" placeholder="Coyote / MAC">
                                    </div>
                                    <div class="settings-item-inner">
                                        <label class="form-label">通道</label>
                                        <select class="select-input w-full" id="dungeon-channel">
                                            <option value="0">通道 A</option>
                                            <option value="1">通道 B</option>
                                        </select>
                                    </div>
                                    <div class="settings-item-inner">
                                        <label class="form-label">强度 (0-100)</label>
                                        <input type="number" class="form-input" id="dungeon-intensity" value="10">
                                    </div>
                                    <div class="settings-item-inner">
                                        <label class="form-label">频率 (Hz)</label>
                                        <input type="number" class="form-input" id="dungeon-frequency" value="100">
                                    </div>
                                    <div class="settings-item-inner">
                                        <label class="form-label">脉冲时长 (ms)</label>
                                        <input type="number" class="form-input" id="dungeon-pulse-ms" value="100">
                                    </div>
                                    <div class="settings-item-inner">
                                        <label class="form-label">间隔时长 (ms)</label>
                                        <input type="number" class="form-input" id="dungeon-pause-ms" value="100">
                                    </div>
                                    <div class="settings-item-inner">
                                        <label class="form-label">循环次数</label>
                                        <input type="number" class="form-input" id="dungeon-count" value="3">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-title">高级设置</div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">
                                    自定义User-Agent
                                </div>
                                <div class="settings-description">
                                    自定义请求的User-Agent
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="custom-ua" />
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="settings-item">
                            <div>
                                <div class="settings-label">User-Agent</div>
                                <div class="settings-description">
                                    自定义的User-Agent字符串
                                </div>
                            </div>
                            <input
                                type="text"
                                class="form-input"
                                id="user-agent"
                                placeholder="Mozilla/5.0..."
                                style="width: 400px"
                            />
                        </div>
                    </div>

                    <div style="margin-top: 24px">
                        <button
                            class="btn btn-primary"
                            onclick="saveSettings()"
                        >
                            保存设置
                        </button>
                        <button
                            class="btn btn-danger"
                            onclick="resetSettings()"
                        >
                            恢复默认
                        </button>
                        <button
                            class="btn btn-success"
                            onclick="testPush()"
                            style="margin-left: 8px"
                        >
                            测试推送
                        </button>
                    </div>
                </div>
            </div>

            <div id="tab-help" class="tab-content">
                <div class="card">
                    <h2 class="card-title">帮助与关于</h2>
                    <p style="margin-bottom: 12px">BTR v7.0.0</p>
                    <p
                        style="
                            color: var(--text-secondary);
                            margin-bottom: 16px;
                        "
                    >
                        本项目完全免费开源，仅供学习使用。
                    </p>

                    <div class="settings-group">
                        <div class="settings-title">使用教程</div>
                        <div
                            style="
                                color: var(--text-secondary);
                                line-height: 1.6;
                            "
                        >
                            <p>
                                1.
                                在"账号管理"中添加B站账号 (支持Cookie登录, 扫码登录, 账号密码登录, 手机号登录）
                            </p>
                            <p>2. 在"项目列表"中选择要抢票的项目</p>
                            <p>3. 在"设置"中配置抢票参数和推送通知</p>
                            <p>4. 在"运行"页面开始抢票并查看实时状态</p>
                            <p>5. 查看运行日志获取详细信息</p>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-title">常见问题</div>
                        <div
                            style="
                                color: var(--text-secondary);
                                line-height: 1.6;
                            "
                        >
                            <p><strong>Q: 如何获取B站Cookie？</strong></p>
                            <p>
                                A:
                                登录B站后，按F12打开开发者工具，在控制台输入<code>document.cookie</code>复制结果
                            </p>

                            <p><strong>Q: 抢票失败怎么办？</strong></p>
                            <p>A: 检查网络连接、账号状态，或尝试更换抢票模式</p>

                            <p><strong>Q: 支持多账号同时抢票吗？</strong></p>
                            <p>A: 支持，可以在账号管理页面启用多个账号</p>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-title">项目信息</div>
                        <div
                            style="
                                color: var(--text-secondary);
                                line-height: 1.6;
                            "
                        >
                            <p>
                                GitHub:
                                <a
                                    href="https://github.com/biliticket/bili_ticket_rush"
                                    target="_blank"
                                    >https://github.com/biliticket/bili_ticket_rush</a
                                >
                            </p>
                            <p>许可证: AGPLv3 License</p>
                            <p>反馈: 请在GitHub Issues中提交问题</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="add-account-modal" class="modal">
            <div class="modal-content" style="max-width: 450px;">
                <h3 class="modal-title">添加账号</h3>
                
                <div class="login-tabs">
                    <div class="login-tab active" data-method="qrcode">扫码登录</div>
                    <div class="login-tab" data-method="sms">手机号登录</div>
                    <div class="login-tab" data-method="cookie">Cookie</div>
                </div>

                <div id="method-qrcode" class="login-method-content active">
                    <div class="qrcode-container" style="margin: 10px 0; position: relative; cursor: pointer;" onclick="handleQrcodeClick()">
                        <img id="qrcode-img" class="qrcode-img" src="" alt="登录二维码" style="width: 180px; height: 180px;" />
                        <div id="qrcode-expired-overlay" style="display: none; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 180px; height: 180px; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(4px); flex-direction: column; align-items: center; justify-content: center; border-radius: 4px;">
                            <div style="color: var(--text-primary); font-weight: 600; margin-bottom: 8px;">二维码已过期</div>
                            <div style="color: var(--accent-color); font-size: 12px;">点击刷新</div>
                        </div>
                    </div>
                    <div id="qrcode-status-text" style="text-align: center; margin-bottom: 16px; color: var(--text-secondary); font-size: 13px;">
                        请使用B站APP扫描二维码登录
                    </div>
                    <div class="modal-actions" style="justify-content: center;">
                        <button class="btn btn-primary" onclick="refreshQrcode()">刷新二维码</button>
                    </div>
                </div>

                <div id="method-sms" class="login-method-content">
                    <div class="form-group">
                        <label class="form-label" for="phone-login-phone">手机号</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="phone-login-cid" class="form-input" style="width: 100px;">
                                <option value="86">中国 +86</option>
                            </select>
                            <input type="tel" class="form-input" id="phone-login-phone" placeholder="请输入手机号" style="flex: 1;" />
                        </div>
                    </div>
                    <div class="form-group" style="display: flex; gap: 10px; align-items: flex-end;">
                        <div style="flex: 1;">
                            <label class="form-label" for="phone-login-sms-code">验证码</label>
                            <input type="text" class="form-input" id="phone-login-sms-code" placeholder="请输入验证码" />
                        </div>
                        <button class="btn btn-secondary" id="phone-login-send-sms-btn" style="margin-bottom: 0;">获取验证码</button>
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-primary" id="phone-login-submit-btn" style="width: 100%; margin-right: 0;">登录</button>
                    </div>
                </div>




                <div id="method-cookie" class="login-method-content">
                    <div class="form-group">
                        <label class="form-label">SESSDATA / Cookie</label>
                        <textarea class="form-input" id="account-cookie" placeholder="请输入完整Cookie或SESSDATA" rows="4"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-primary" onclick="submitAddAccount()" style="width: 100%; margin-right: 0;">添加</button>
                    </div>
                </div>

                <div class="modal-actions" style="border-top: 1px solid var(--border-color); margin-top: 15px; padding-top: 15px;">
                    <button class="btn btn-danger" onclick="closeAddAccountModal()" style="margin-bottom: 0;">关闭</button>
                </div>
            </div>
        </div>

        <div id="add-project-modal" class="modal">
            <div class="modal-content">
                <h3 class="modal-title">添加项目</h3>
                <div class="form-group">
                    <label class="form-label">项目ID</label>
                    <input
                        type="text"
                        class="form-input"
                        id="project-id"
                        placeholder="请输入项目ID"
                    />
                </div>
                <div class="form-group">
                    <label class="form-label">项目名称</label>
                    <input
                        type="text"
                        class="form-input"
                        id="project-name"
                        placeholder="请输入项目名称"
                    />
                </div>
                <div class="modal-actions">
                    <button
                        class="btn btn-primary"
                        onclick="submitAddProject()"
                    >
                        添加
                    </button>
                    <button
                        class="btn btn-danger"
                        onclick="closeAddProjectModal()"
                    >
                        取消
                    </button>
                </div>
            </div>
        </div>

        <div id="screen-ticket-modal" class="modal">
            <div class="modal-content">
                <h3 class="modal-title">选择场次、票种和购票人</h3>

                <div
                    id="screen-ticket-loading"
                    style="text-align: center; padding: 20px"
                >
                    <div class="spinner"></div>
                    <p>正在加载项目详情...</p>
                </div>

                <div id="screen-ticket-selector" style="display: none">
                    <div class="form-group">
                        <label class="form-label">场次</label>
                        <select id="screen-select" class="form-input"></select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">票种</label>
                        <select id="ticket-select" class="form-input"></select>
                    </div>

                    <div class="form-group" style="display: none">
                        <label id="buyer-type-label" class="form-label"
                            >购票人类型</label
                        >
                        <select id="buyer-type-select" class="form-input">
                            <option value="1">实名购票人</option>
                            <option value="0">非实名购票人</option>
                        </select>
                    </div>

                    <div id="real-name-buyer-section">
                        <div class="form-group">
                            <label class="form-label">实名购票人</label>
                            <div
                                id="buyer-loading"
                                style="
                                    display: none;
                                    padding: 10px;
                                    text-align: center;
                                "
                            >
                                <div
                                    class="spinner"
                                    style="width: 20px; height: 20px"
                                ></div>
                                <span style="margin-left: 10px"
                                    >正在加载购票人...</span
                                >
                            </div>
                            <div id="buyer-list" style="display: none"></div>
                            <div
                                id="buyer-error"
                                style="
                                    display: none;
                                    color: #ff4444;
                                    padding: 10px;
                                "
                            >
                                加载购票人失败，请重试
                            </div>
                        </div>
                    </div>

                    <div id="non-real-name-buyer-section" style="display: none">
                        <div class="form-group">
                            <label class="form-label">姓名</label>
                            <input
                                type="text"
                                id="no-bind-name"
                                class="form-input"
                                placeholder="请输入姓名"
                            />
                        </div>
                        <div class="form-group">
                            <label class="form-label">手机号</label>
                            <input
                                type="tel"
                                id="no-bind-tel"
                                class="form-input"
                                placeholder="请输入手机号"
                            />
                        </div>
                        <div class="form-group">
                            <button
                                class="btn btn-secondary"
                                onclick="saveNoBindBuyerInfo()"
                            >
                                保存非实名购票人信息
                            </button>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button
                            class="btn btn-primary"
                            onclick="confirmScreenTicketSelection()"
                        >
                            确认选择
                        </button>
                        <button
                            class="btn btn-danger"
                            onclick="closeScreenTicketModal()"
                        >
                            取消
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="grab-success-modal" class="modal">
            <div class="modal-content">
                <h3 class="modal-title" style="color: var(--success-color);">🎉 抢票成功！</h3>
                <div class="success-info-grid">
                    <div><strong>项目:</strong> <span id="success-project-name"></span></div>
                    <div><strong>场次:</strong> <span id="success-screen-name"></span></div>
                    <div><strong>票种:</strong> <span id="success-ticket-name"></span></div>
                    <div><strong>价格:</strong> ¥<span id="success-ticket-price"></span></div>
                </div>
                <div class="qrcode-container" style="margin-top: 16px;">
                    <img id="payment-qrcode-img" class="qrcode-img" src="" alt="支付二维码" />
                </div>
                <div style="text-align: center; margin: 16px 0; color: var(--text-secondary);">
                    请尽快扫码支付，以免订单失效！
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="closeGrabSuccessModal()">关闭</button>
                </div>
            </div>
        </div>

        <div id="phone-login-modal" class="modal"></div>
        <script src="app.js"></script>
    </body>
</html>
